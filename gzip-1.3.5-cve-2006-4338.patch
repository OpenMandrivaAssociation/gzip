diff -Naurp gzip-1.5/unlzh.c gzip-1.5.oden/unlzh.c
--- gzip-1.5/unlzh.c	2012-06-20 16:35:13.000000000 +0200
+++ gzip-1.5.oden/unlzh.c	2012-06-20 16:35:27.000000000 +0200
@@ -256,7 +256,7 @@ local void read_c_len()
                     if (bitbuf & mask) c = right[c];
                     else               c = left [c];
                     mask >>= 1;
-                } while (c >= NT);
+		} while (c >= NT && (mask || c != left[c]));
             }
             fillbuf((int) pt_len[c]);
             if (c <= 2) {
@@ -292,7 +292,7 @@ local unsigned decode_c()
             if (bitbuf & mask) j = right[j];
             else               j = left [j];
             mask >>= 1;
-        } while (j >= NC);
+	} while (j >= NC && (mask || j != left[j])); 
     }
     fillbuf((int) c_len[j]);
     return j;
@@ -309,7 +309,7 @@ local unsigned decode_p()
             if (bitbuf & mask) j = right[j];
             else               j = left [j];
             mask >>= 1;
-        } while (j >= NP);
+	} while (j >= NP && (mask || j != left[j]));
     }
     fillbuf((int) pt_len[j]);
     if (j != 0) j = ((unsigned) 1 << (j - 1)) + getbits((int) (j - 1));
